<h2>Unit Testing</h2>

<p>In ModuleInject every class that fullfills the <code>IInjectionModule</code> interface can be used as a submodule of other modules.</p>

<p>This also leads to the fact that you can mock submodules if you keep the invariants of the <code>IInjectionModule</code> interface in mind:</p>

<ul>
<li>If <code>IsResolved</code> is true, all component properties of the public interface are filled.</li>
<li>Calling <code>Resolve</code> leads to <code>IsResolved</code> being true.</li>
<li><p>Component factories of the public interface, <code>GetComponent</code> and <code>GetComponent&lt;T&gt;</code> always return instances according to the registrations in the module.</p>

<p>You can for example use Moq to create a mock for the following module interface:</p>

<p>public interface IMockedModule : IInjectionModule
 {
     IMockedComponent MockedComponent { get; set; }</p>

<pre><code> IMockedComponent CreateMockedComponent();
</code></pre>

<p>}</p></li>
</ul>

<p>The creation of the mock would look like this:</p>

<pre><code>// create module mock
var moduleMock = new Mock&lt;IMockedModule&gt;();

// setup component getter
moduleMock.SetupGet(x =&gt; x.MockedComponent).Returns(Mock.Of&lt;IMockedComponent&gt;());

// setup component factory
moduleMock.Setup(x =&gt; x.CreateMockedComponent()).Returns(Mock.Of&lt;IMockedComponent&gt;());
</code></pre>

<p>How you introduce the mock into the tested module can vary depending on the use case.
 - If the mocked module comes from a registry, you can set one in the test that contains the mocked module.
 - If the mocked module comes from a (C#-)public property you can set that property in the test.
   (ModuleInject will not Resolve component properties that are already set)
 - Else you have to provide some means to inject it in the tests.</p>

<p>Example code for introduction via a registry:</p>

<pre><code>// create registry containing the mock created above
mockRegistry = new StandardRegistry();
mockRegistry.Register&lt;IMockedModule&gt;(() =&gt; moduleMock.Object);

// apply the registry to the tested module
testedModule.Registry = mockRegistry;
</code></pre>
